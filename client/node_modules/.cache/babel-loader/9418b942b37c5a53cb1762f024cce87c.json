{"ast":null,"code":"import _classCallCheck from\"/Users/brittany/repos/dashboard-test/dashboard-test/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _classPrivateFieldLooseBase from\"/Users/brittany/repos/dashboard-test/dashboard-test/client/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase\";import _classPrivateFieldLooseKey from\"/Users/brittany/repos/dashboard-test/dashboard-test/client/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey\";import axios from\"axios\";import{features}from\"../data/countries.json\";import legendItems from\"../entities/LegendItems\";var _processData=_classPrivateFieldLooseKey(\"processData\");var _setCountryColor=_classPrivateFieldLooseKey(\"setCountryColor\");var LoadCountriesTask=function LoadCountriesTask(){var _this=this;_classCallCheck(this,LoadCountriesTask);this.mentionsUrl=\"http://localhost:5000/events/countries\";this.setState=null;this.mapCountries=features;this.load=function(setState){_this.setState=setState;axios.get(\"http://localhost:5000/events/countries\").then(function(result){return _classPrivateFieldLooseBase(_this,_processData)[_processData](result.data);}).catch(function(error){return console.log(error);});};Object.defineProperty(this,_processData,{writable:true,value:function value(countryMentions){var _loop=function _loop(i){var mapCountry=_this.mapCountries[i];var countryMention=countryMentions.find(function(countryMention){return countryMention._id===mapCountry.properties.ADMIN;}//mapCountry.properties.ISO_A3\n);mapCountry.properties.mentionsNumber=0;mapCountry.properties.mentionsText=\"\";if(countryMention!=null){var mentions=Number(countryMention.count);mapCountry.properties.mentionsNumber=mentions;mapCountry.properties.mentionsText=\"\".concat(mentions,\" mentions in last 24 hours\");}_classPrivateFieldLooseBase(_this,_setCountryColor)[_setCountryColor](mapCountry);};for(var i=0;i<_this.mapCountries.length;i++){_loop(i);}_this.setState(_this.mapCountries);}});Object.defineProperty(this,_setCountryColor,{writable:true,value:function value(mapCountry){var legendItem=legendItems.find(function(legendItem){return legendItem.isFor(mapCountry.properties.mentionsNumber);});if(legendItem!=null){mapCountry.properties.color=legendItem.color;}}});};export{LoadCountriesTask as default};","map":{"version":3,"sources":["/Users/brittany/repos/dashboard-test/dashboard-test/client/src/tasks/LoadCountriesTask.js"],"names":["axios","features","legendItems","LoadCountriesTask","mentionsUrl","setState","mapCountries","load","get","then","result","data","catch","error","console","log","countryMentions","i","mapCountry","countryMention","find","_id","properties","ADMIN","mentionsNumber","mentionsText","mentions","Number","count","length","legendItem","isFor","color"],"mappings":"2dAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,KAAyB,wBAAzB,CACA,MAAOC,CAAAA,WAAP,KAAwB,yBAAxB,C,iIAEqBC,CAAAA,iB,0FACnBC,W,CAAc,wC,MACdC,Q,CAAW,I,MACXC,Y,CAAeL,Q,MAEfM,I,CAAO,SAACF,QAAD,CAAc,CACnB,KAAI,CAACA,QAAL,CAAgBA,QAAhB,CACAL,KAAK,CACFQ,GADH,CACO,wCADP,EAEGC,IAFH,CAEQ,SAACC,MAAD,qCAAY,KAAZ,6BAA8BA,MAAM,CAACC,IAArC,GAFR,EAGGC,KAHH,CAGS,SAACC,KAAD,QAAWC,CAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAX,EAHT,EAID,C,8DAEc,eAACG,eAAD,CAAqB,0BACzBC,CADyB,EAEhC,GAAMC,CAAAA,UAAU,CAAG,KAAI,CAACZ,YAAL,CAAkBW,CAAlB,CAAnB,CACA,GAAME,CAAAA,cAAc,CAAGH,eAAe,CAACI,IAAhB,CACrB,SAACD,cAAD,QAAoBA,CAAAA,cAAc,CAACE,GAAf,GAAuBH,UAAU,CAACI,UAAX,CAAsBC,KAAjE,EAAuE;AADlD,CAAvB,CAIAL,UAAU,CAACI,UAAX,CAAsBE,cAAtB,CAAuC,CAAvC,CACAN,UAAU,CAACI,UAAX,CAAsBG,YAAtB,CAAqC,EAArC,CAEA,GAAIN,cAAc,EAAI,IAAtB,CAA4B,CAC1B,GAAMO,CAAAA,QAAQ,CAAGC,MAAM,CAACR,cAAc,CAACS,KAAhB,CAAvB,CACAV,UAAU,CAACI,UAAX,CAAsBE,cAAtB,CAAuCE,QAAvC,CACAR,UAAU,CAACI,UAAX,CAAsBG,YAAtB,WAAwCC,QAAxC,+BACD,CACD,4BAAA,KAAI,kBAAJ,mBAAsBR,UAAtB,EAfgC,EAClC,IAAK,GAAID,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAI,CAACX,YAAL,CAAkBuB,MAAtC,CAA8CZ,CAAC,EAA/C,CAAmD,OAA1CA,CAA0C,EAelD,CACD,KAAI,CAACZ,QAAL,CAAc,KAAI,CAACC,YAAnB,EACD,C,oEAEkB,eAACY,UAAD,CAAgB,CACjC,GAAMY,CAAAA,UAAU,CAAG5B,WAAW,CAACkB,IAAZ,CAAiB,SAACU,UAAD,QAClCA,CAAAA,UAAU,CAACC,KAAX,CAAiBb,UAAU,CAACI,UAAX,CAAsBE,cAAvC,CADkC,EAAjB,CAAnB,CAGA,GAAIM,UAAU,EAAI,IAAlB,CAAwB,CACtBZ,UAAU,CAACI,UAAX,CAAsBU,KAAtB,CAA8BF,UAAU,CAACE,KAAzC,CACD,CACF,C,YAxCkB7B,iB","sourcesContent":["import axios from \"axios\";\nimport { features } from \"../data/countries.json\";\nimport legendItems from \"../entities/LegendItems\";\n\nexport default class LoadCountriesTask {\n  mentionsUrl = \"http://localhost:5000/events/countries\";\n  setState = null;\n  mapCountries = features;\n\n  load = (setState) => {\n    this.setState = setState;\n    axios\n      .get(\"http://localhost:5000/events/countries\")\n      .then((result) => this.#processData(result.data))\n      .catch((error) => console.log(error));\n  };\n\n  #processData = (countryMentions) => {\n    for (let i = 0; i < this.mapCountries.length; i++) {\n      const mapCountry = this.mapCountries[i];\n      const countryMention = countryMentions.find(\n        (countryMention) => countryMention._id === mapCountry.properties.ADMIN //mapCountry.properties.ISO_A3\n      );\n\n      mapCountry.properties.mentionsNumber = 0;\n      mapCountry.properties.mentionsText = \"\";\n\n      if (countryMention != null) {\n        const mentions = Number(countryMention.count);\n        mapCountry.properties.mentionsNumber = mentions;\n        mapCountry.properties.mentionsText = `${mentions} mentions in last 24 hours`;\n      }\n      this.#setCountryColor(mapCountry);\n    }\n    this.setState(this.mapCountries);\n  };\n\n  #setCountryColor = (mapCountry) => {\n    const legendItem = legendItems.find((legendItem) =>\n      legendItem.isFor(mapCountry.properties.mentionsNumber)\n    );\n    if (legendItem != null) {\n      mapCountry.properties.color = legendItem.color;\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}