{"ast":null,"code":"import _classPrivateFieldLooseBase from \"/Users/brittany/repos/dashboard-test/dashboard-test/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase\";\nimport _classPrivateFieldLooseKey from \"/Users/brittany/repos/dashboard-test/dashboard-test/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey\";\n// import papa from \"papaparse\";\nimport axios from \"axios\";\nimport { features } from \"../data/countries.json\";\nimport legendItems from \"../entities/LegendItems\";\n\nvar _processCovidData = _classPrivateFieldLooseKey(\"processCovidData\");\n\nvar _setCountryColor = _classPrivateFieldLooseKey(\"setCountryColor\");\n\nclass LoadCountriesTask {\n  constructor() {\n    this.covid19DataUrl = \"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/web-data/data/cases_country.csv\";\n    this.mentionsUrl = \"http://localhost:5000/events/mentions\";\n    this.setState = null;\n    this.mapCountries = features;\n\n    this.load = setState => {\n      this.setState = setState; // papa.parse(this.covid19DataUrl, {\n      //   download: true,\n      //   header: true,\n      //   complete: (result) => this.#processCovidData(result.data),\n      // });\n\n      axios.get(\"http://localhost:5000/events/mentions\") // .then((res) => console.log(res.data))\n      .then(result => _classPrivateFieldLooseBase(this, _processCovidData)[_processCovidData](result.data)) // .then((result) => this.#processCovidData(result.data))\n      .catch(error => console.log(error));\n    };\n\n    Object.defineProperty(this, _processCovidData, {\n      writable: true,\n      value: countryMentions => {\n        // For every country received from the country mentions endpoint\n        for (let i = 0; i < this.mapCountries.length; i++) {\n          // assign mapCountry to each item\n          const mapCountry = this.mapCountries[i]; // assign countrymention to countries that match the name of each map item\n\n          const countryMention = countryMentions.find(countryMention => countryMention._id === mapCountry.properties.ADMIN //mapCountry.properties.ISO_A3\n          ); // set two new properies on the country json file:\n          // confirmed field set to a number : in my case, mention\n          // confirmedText field set to text : Template literal from original map\n\n          mapCountry.properties.mentionsNumber = 0; // mapCountry.properties.confirmed = 0;\n\n          mapCountry.properties.mentionsText = \"\"; // confirmedText\n          // If the country has any mentions....\n\n          if (countryMention != null) {\n            // Declare a variable converting the mention count to a number (To be sure)\n            const mentions = Number(countryMention.count); // Assign the mentions count to the mentionsNumber field\n\n            mapCountry.properties.mentionsNumber = mentions; // Assign a template literal to the mentionsText field\n\n            mapCountry.properties.mentionsText = `${mentions} mentions in last 24 hours`;\n          } // Then, find the country color for each country\n\n\n          _classPrivateFieldLooseBase(this, _setCountryColor)[_setCountryColor](mapCountry);\n        }\n\n        this.setState(this.mapCountries);\n        console.log(this.mapCountries[7]); // Test for UAE\n\n        console.log(this.mapCountries[8]); // Test for country with no mentions\n      }\n    });\n    Object.defineProperty(this, _setCountryColor, {\n      writable: true,\n      value: mapCountry => {\n        // In the legned items, look for the item corresponding with the bracket number\n        const legendItem = legendItems.find(legendItem => // Pass the number of mentions to the function in legendItems\n        legendItem.isFor(mapCountry.properties.mentionsNumber)); // if the legend item is not empty, assign the color of the item to the country\n\n        if (legendItem != null) {\n          mapCountry.properties.color = legendItem.color;\n        }\n      }\n    });\n  } // #formatNumberWithCommas = function (number) {\n  //   return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  // };\n\n\n}\n\nexport default LoadCountriesTask;","map":{"version":3,"sources":["/Users/brittany/repos/dashboard-test/dashboard-test/src/tasks/LoadCountriesTask.js"],"names":["axios","features","legendItems","LoadCountriesTask","covid19DataUrl","mentionsUrl","setState","mapCountries","load","get","then","result","data","catch","error","console","log","countryMentions","i","length","mapCountry","countryMention","find","_id","properties","ADMIN","mentionsNumber","mentionsText","mentions","Number","count","legendItem","isFor","color"],"mappings":";;AAAA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,wBAAzB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;;;;;;AAEA,MAAMC,iBAAN,CAAwB;AAAA;AAAA,SACtBC,cADsB,GAEpB,2FAFoB;AAAA,SAGtBC,WAHsB,GAGR,uCAHQ;AAAA,SAKtBC,QALsB,GAKX,IALW;AAAA,SAMtBC,YANsB,GAMPN,QANO;;AAAA,SAQtBO,IARsB,GAQdF,QAAD,IAAc;AACnB,WAAKA,QAAL,GAAgBA,QAAhB,CADmB,CAEnB;AACA;AACA;AACA;AACA;;AAEAN,MAAAA,KAAK,CACFS,GADH,CACO,uCADP,EAEE;AAFF,OAGGC,IAHH,CAGSC,MAAD,gCAAY,IAAZ,wCAAmCA,MAAM,CAACC,IAA1C,CAHR,EAIE;AAJF,OAKGC,KALH,CAKUC,KAAD,IAAWC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CALpB;AAMD,KAtBqB;;AAAA;AAAA;AAAA,aAwBDG,eAAD,IAAqB;AACvC;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKX,YAAL,CAAkBY,MAAtC,EAA8CD,CAAC,EAA/C,EAAmD;AACjD;AACA,gBAAME,UAAU,GAAG,KAAKb,YAAL,CAAkBW,CAAlB,CAAnB,CAFiD,CAGjD;;AACA,gBAAMG,cAAc,GAAGJ,eAAe,CAACK,IAAhB,CACpBD,cAAD,IAAoBA,cAAc,CAACE,GAAf,KAAuBH,UAAU,CAACI,UAAX,CAAsBC,KAD5C,CACkD;AADlD,WAAvB,CAJiD,CAOjD;AACA;AACA;;AACAL,UAAAA,UAAU,CAACI,UAAX,CAAsBE,cAAtB,GAAuC,CAAvC,CAViD,CAUP;;AAC1CN,UAAAA,UAAU,CAACI,UAAX,CAAsBG,YAAtB,GAAqC,EAArC,CAXiD,CAWR;AACzC;;AACA,cAAIN,cAAc,IAAI,IAAtB,EAA4B;AAC1B;AACA,kBAAMO,QAAQ,GAAGC,MAAM,CAACR,cAAc,CAACS,KAAhB,CAAvB,CAF0B,CAG1B;;AACAV,YAAAA,UAAU,CAACI,UAAX,CAAsBE,cAAtB,GAAuCE,QAAvC,CAJ0B,CAK1B;;AACAR,YAAAA,UAAU,CAACI,UAAX,CAAsBG,YAAtB,GAAsC,GAAEC,QAAS,4BAAjD;AACD,WApBgD,CAqBjD;;;AACA,gFAAsBR,UAAtB;AACD;;AACD,aAAKd,QAAL,CAAc,KAAKC,YAAnB;AACAQ,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKT,YAAL,CAAkB,CAAlB,CAAZ,EA3BuC,CA2BJ;;AACnCQ,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKT,YAAL,CAAkB,CAAlB,CAAZ,EA5BuC,CA4BJ;AACpC;AArDqB;AAAA;AAAA;AAAA,aAsDFa,UAAD,IAAgB;AACjC;AACA,cAAMW,UAAU,GAAG7B,WAAW,CAACoB,IAAZ,CAAkBS,UAAD,IAClC;AACAA,QAAAA,UAAU,CAACC,KAAX,CAAiBZ,UAAU,CAACI,UAAX,CAAsBE,cAAvC,CAFiB,CAAnB,CAFiC,CAMjC;;AACA,YAAIK,UAAU,IAAI,IAAlB,EAAwB;AACtBX,UAAAA,UAAU,CAACI,UAAX,CAAsBS,KAAtB,GAA8BF,UAAU,CAACE,KAAzC;AACD;AACF;AAhEqB;AAAA,IAkEtB;AACA;AACA;;;AApEsB;;AAuExB,eAAe9B,iBAAf","sourcesContent":["// import papa from \"papaparse\";\nimport axios from \"axios\";\nimport { features } from \"../data/countries.json\";\nimport legendItems from \"../entities/LegendItems\";\n\nclass LoadCountriesTask {\n  covid19DataUrl =\n    \"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/web-data/data/cases_country.csv\";\n  mentionsUrl = \"http://localhost:5000/events/mentions\";\n\n  setState = null;\n  mapCountries = features;\n\n  load = (setState) => {\n    this.setState = setState;\n    // papa.parse(this.covid19DataUrl, {\n    //   download: true,\n    //   header: true,\n    //   complete: (result) => this.#processCovidData(result.data),\n    // });\n\n    axios\n      .get(\"http://localhost:5000/events/mentions\")\n      // .then((res) => console.log(res.data))\n      .then((result) => this.#processCovidData(result.data))\n      // .then((result) => this.#processCovidData(result.data))\n      .catch((error) => console.log(error));\n  };\n\n  #processCovidData = (countryMentions) => {\n    // For every country received from the country mentions endpoint\n    for (let i = 0; i < this.mapCountries.length; i++) {\n      // assign mapCountry to each item\n      const mapCountry = this.mapCountries[i];\n      // assign countrymention to countries that match the name of each map item\n      const countryMention = countryMentions.find(\n        (countryMention) => countryMention._id === mapCountry.properties.ADMIN //mapCountry.properties.ISO_A3\n      );\n      // set two new properies on the country json file:\n      // confirmed field set to a number : in my case, mention\n      // confirmedText field set to text : Template literal from original map\n      mapCountry.properties.mentionsNumber = 0; // mapCountry.properties.confirmed = 0;\n      mapCountry.properties.mentionsText = \"\"; // confirmedText\n      // If the country has any mentions....\n      if (countryMention != null) {\n        // Declare a variable converting the mention count to a number (To be sure)\n        const mentions = Number(countryMention.count);\n        // Assign the mentions count to the mentionsNumber field\n        mapCountry.properties.mentionsNumber = mentions;\n        // Assign a template literal to the mentionsText field\n        mapCountry.properties.mentionsText = `${mentions} mentions in last 24 hours`;\n      }\n      // Then, find the country color for each country\n      this.#setCountryColor(mapCountry);\n    }\n    this.setState(this.mapCountries);\n    console.log(this.mapCountries[7]); // Test for UAE\n    console.log(this.mapCountries[8]); // Test for country with no mentions\n  };\n  #setCountryColor = (mapCountry) => {\n    // In the legned items, look for the item corresponding with the bracket number\n    const legendItem = legendItems.find((legendItem) =>\n      // Pass the number of mentions to the function in legendItems\n      legendItem.isFor(mapCountry.properties.mentionsNumber)\n    );\n    // if the legend item is not empty, assign the color of the item to the country\n    if (legendItem != null) {\n      mapCountry.properties.color = legendItem.color;\n    }\n  };\n\n  // #formatNumberWithCommas = function (number) {\n  //   return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  // };\n}\n\nexport default LoadCountriesTask;\n"]},"metadata":{},"sourceType":"module"}